!function(e){function t(e){e=e||[],p=p||document.getElementById("cachedColorCardTemplateTpl").innerHTML;var t,n=p,a=[];return e.forEach(function(e,o){t=o?n:n.substring(3),t=t.replace(/\*\*colorName\*\*/g,e.name).replace(/\*\*colorLabel\*\*/g,e.label).replace(/\*\*jsonColor\*\*/g,JSON.stringify(e)),a.push(t)}),a.join("")}function n(e){f=f||document.getElementById("cachedTemplateTpl").innerHTML;var t=f;return e.name=e.name||"bada55",e.label=e.label||"badass",t.replace(/\*\*colorName\*\*/g,e.name).replace(/\*\*colorNameUpper\*\*/g,e.name.toUpperCase()).replace(/\*\*colorLabelUpper\*\*/g,e.label.toUpperCase()).replace(/\*\*colorUrl\*\*/g,"http://bada55.io/"+e.name).replace(/\*\*colorId\*\*/g,e.id).replace(/\*\*hasVotedClass\*\*/g,e.hasVoted?"rated":"")}function a(t,n,a){t.preventDefault(),a=1,d.add(".menu-trigger").removeClass("pushed");var o=Math.ceil(e(document.getElementById(n)).offset().top-70)*a,i=Math.abs(Math.ceil(e(document).scrollTop()-o));i=i>1500?1500:i,e("html,body").animate({scrollTop:o},i,"easeInOutQuint",function(){"submit"===n&&e(".submit-card .flip-card").addClass("flipped")})}function o(){setTimeout(function(){r.find(".submit-card .respond").fadeOut("fast",function(){e(this).remove()})},4e3)}function i(t){var n="",a="38384040373937396665";e(document).keydown(function(e){27===e.keyCode&&r.find(".flipped").removeClass("flipped"),-1!==a.indexOf(e.keyCode)?(n+=e.keyCode,-1!==n.indexOf(a)&&(t(),n="")):n=""})}jQuery.extend(jQuery.easing,{easeInOutQuint:function(e,t,n,a,o){return(t/=o/2)<1?a/2*t*t*t*t*t+n:a/2*((t-=2)*t*t*t*t+2)+n}});var r=e(document.body),c=e(document),s=e(window),l=r.find(".alert-msg"),d=r.find('[role="banner"]'),u=e("#about"),f="",p="",m=1;r.on("click",".flip-trigger",function(t){t.preventDefault();var a=e(this),o=a.next(".face-back");a.parents(".flip-card").toggleClass("flipped"),"button"!==t.currentTarget.nodeName.toLowerCase()&&(o.find(".btn-back").length||o.html(n(a.data("color"))))}),e("#i1").on("blur",function(){var t=this.value,n=e(this).parents(".face-back");!/^[a-f0-9]{3,6}$/.test(t)||3!==t.length&&6!==t.length?n.css("backgroundColor","#ccc"):n.css("backgroundColor","#"+t)}),r.on("click",".im-submit",function(e){a(e,"submit")}),r.on("click",".im-about",function(e){a(e,"about")}),r.on("click",".totop-link",function(e){a(e,"top")}),r.on("click",".menu-trigger button",function(e){e.preventDefault(),d.add(".menu-trigger").toggleClass("pushed")}),r.on("click",".btn-rate",function(t){t.preventDefault();var n=e(this);setTimeout(function(){l.removeClass("active").empty()},4e3),e.get(this.dataset.url).success(function(e){l.addClass("active").html(e.msg),n.addClass("rated")}).error(function(e){l.addClass("active").html(e.responseJSON.msg)})}),r.on("submit",".submit-card form",function(t){t.preventDefault();var n=e(this);n.append("<div class='respond'><div><img src='img/spinner.svg'></div></div>").find(".respond").fadeIn("fast").parents(".face-back").css("backgroundColor","#ccc"),e.post(this.action,n.serializeArray()).success(function(e){r.find(".submit-card .respond div").html(e.msg)}).error(function(e){r.find(".submit-card .respond div").html(e.responseJSON.msg),o()}).done(function(){n.find("input").val(""),o()})}),i(function(){r.find(".face-front").css("background-image","url(img/chuck.jpg)")});var g={total:0,maxPage:1},b=!1;e.get(window.location.origin+"/colorstats").then(function(e){var t=e.total/200;g.total=e.total,g.maxPage=~~t!==t?~~t+1:t}),s.scroll(function(){s.scrollTop()>=c.height()-s.height()-400&&(m===g.maxPage||b||(b=!0,e.get(window.location.origin+"/lazyload?page="+ ++m+"&state="+window.location.pathname.substring(1)).then(function(e){u.get(0).insertAdjacentHTML("beforeBegin",t(e.data)),b=!1})))})}(jQuery);